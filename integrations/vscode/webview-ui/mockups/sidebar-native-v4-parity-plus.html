<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sentinel Sidebar v4 - Competitor Parity+</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap");

      :root {
        color-scheme: dark;
        --bg: #101319;
        --panel: #161b23;
        --panel-2: #1b222d;
        --line: #2a3443;
        --line-soft: #212a37;
        --text: #e7edf8;
        --muted: #a6b2c7;
        --subtle: #7f8ba1;
        --accent: #46ccb5;
        --accent-soft: rgba(70, 204, 181, 0.16);
        --ok: #49cd7f;
        --warn: #dca046;
        --danger: #dd6678;
        --radius-xl: 16px;
        --radius-lg: 12px;
        --radius-md: 10px;
        --shadow: 0 12px 26px rgba(0, 0, 0, 0.28);
      }

      [data-theme="warm-graphite"] {
        --bg: #151210;
        --panel: #1e1916;
        --panel-2: #26201b;
        --line: #3b322a;
        --line-soft: #312920;
        --text: #efe5d9;
        --muted: #c6b198;
        --subtle: #947f69;
        --accent: #d2a26b;
        --accent-soft: rgba(210, 162, 107, 0.17);
        --ok: #87c986;
        --warn: #e2af58;
        --danger: #dd8490;
      }

      [data-theme="pure-vscode"] {
        --bg: var(--vscode-sideBar-background, #1f1f1f);
        --panel: var(--vscode-editor-background, #252526);
        --panel-2: color-mix(in oklab, var(--vscode-editor-background, #252526) 92%, white);
        --line: var(--vscode-widget-border, #454545);
        --line-soft: color-mix(in oklab, var(--vscode-widget-border, #454545) 75%, transparent);
        --text: var(--vscode-editor-foreground, #d4d4d4);
        --muted: var(--vscode-descriptionForeground, #a0a0a0);
        --subtle: var(--vscode-disabledForeground, #7f7f7f);
        --accent: var(--vscode-button-background, #0e639c);
        --accent-soft: color-mix(in oklab, var(--vscode-button-background, #0e639c) 22%, transparent);
        --ok: var(--vscode-testing-iconPassed, #89d185);
        --warn: var(--vscode-editorWarning-foreground, #cca700);
        --danger: var(--vscode-editorError-foreground, #f14c4c);
      }

      * { box-sizing: border-box; }

      html,
      body {
        margin: 0;
        height: 100%;
        overflow: hidden;
        font-family: Inter, system-ui, -apple-system, sans-serif;
        background: radial-gradient(circle at 90% -10%, rgba(120, 120, 120, 0.1), transparent 32%), var(--bg);
        color: var(--text);
      }

      .app {
        width: min(100vw, 392px);
        height: 100vh;
        margin: 0 auto;
        border-left: 1px solid var(--line-soft);
        border-right: 1px solid var(--line-soft);
        display: grid;
        grid-template-rows: auto auto 1fr auto;
        background: linear-gradient(180deg, color-mix(in oklab, var(--panel) 96%, black), var(--bg));
      }

      .head {
        padding: 10px;
        border-bottom: 1px solid var(--line);
        background: var(--panel);
      }

      .head-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 12px;
        letter-spacing: 0.08em;
        font-weight: 700;
      }

      .brand-dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: var(--accent);
        box-shadow: 0 0 10px color-mix(in oklab, var(--accent) 70%, transparent);
      }

      .head-actions { display: flex; gap: 6px; }

      .icon-btn,
      .mini-btn {
        border: 1px solid var(--line);
        border-radius: 8px;
        background: var(--panel-2);
        color: var(--muted);
        font-size: 10px;
        height: 28px;
        padding: 0 8px;
        cursor: pointer;
        transition: 120ms ease;
      }

      .icon-btn:hover,
      .mini-btn:hover {
        transform: translateY(-1px);
        border-color: color-mix(in oklab, var(--accent) 45%, var(--line));
        color: var(--text);
      }

      .status {
        margin-top: 8px;
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
      }

      .pill {
        border: 1px solid var(--line);
        border-radius: 999px;
        padding: 3px 8px;
        font-size: 10px;
        color: var(--muted);
        background: var(--panel-2);
      }

      .pill.ok { color: var(--ok); }

      .tabbar {
        padding: 8px 10px;
        border-bottom: 1px solid var(--line);
        background: var(--panel);
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 6px;
      }

      .tab {
        border: 1px solid var(--line);
        border-radius: 9px;
        background: var(--panel-2);
        color: var(--subtle);
        font-size: 10px;
        font-weight: 700;
        height: 30px;
        cursor: pointer;
        transition: 120ms ease;
      }

      .tab:hover {
        color: var(--text);
        border-color: color-mix(in oklab, var(--accent) 30%, var(--line));
      }

      .tab.active {
        color: var(--text);
        border-color: color-mix(in oklab, var(--accent) 56%, var(--line));
        background: color-mix(in oklab, var(--accent-soft) 100%, var(--panel-2));
      }

      .body {
        min-height: 0;
        overflow: hidden;
        position: relative;
      }

      .page {
        position: absolute;
        inset: 0;
        overflow: auto;
        padding: 10px;
        display: grid;
        gap: 9px;
        align-content: start;
        opacity: 0;
        transform: translateY(8px);
        pointer-events: none;
        transition: 140ms ease;
      }

      .page.active {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
      }

      .card {
        border: 1px solid var(--line);
        border-radius: var(--radius-lg);
        background: linear-gradient(180deg, var(--panel), color-mix(in oklab, var(--panel-2) 94%, black));
        padding: 10px;
        box-shadow: 0 2px 0 color-mix(in oklab, white 2%, transparent) inset;
      }

      .card h3 {
        margin: 0 0 7px;
        font-size: 12px;
      }

      .card p {
        margin: 0;
        color: var(--muted);
        font-size: 11px;
        line-height: 1.5;
      }

      .kv { display: grid; gap: 6px; }

      .row {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        font-size: 11px;
      }

      .row span:first-child { color: var(--muted); }

      .row span:last-child {
        font-family: "JetBrains Mono", ui-monospace, Menlo, monospace;
      }

      .list { display: grid; gap: 7px; }

      .item {
        border: 1px solid var(--line);
        border-radius: var(--radius-md);
        background: var(--panel-2);
        padding: 8px;
      }

      .item strong {
        display: block;
        font-size: 11px;
        margin-bottom: 3px;
      }

      .item small { color: var(--muted); font-size: 10px; }

      .empty-hero {
        min-height: 58vh;
        display: grid;
        align-content: center;
        justify-items: center;
        gap: 12px;
        text-align: center;
      }

      .empty-hero .bot {
        width: 66px;
        height: 66px;
        border-radius: 16px;
        border: 1px solid var(--line);
        background: var(--panel-2);
        display: grid;
        place-items: center;
        font-size: 30px;
      }

      .empty-hero h2 {
        margin: 0;
        font-size: 34px;
        line-height: 1.05;
        letter-spacing: -0.02em;
      }

      .empty-hero .recent {
        color: var(--muted);
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.07em;
      }

      .msg {
        display: grid;
        gap: 4px;
      }

      .meta {
        font-size: 9px;
        color: var(--subtle);
        letter-spacing: 0.11em;
        text-transform: uppercase;
      }

      .bubble {
        border: 1px solid var(--line);
        border-radius: 12px;
        background: var(--panel);
        padding: 10px;
        font-size: 12px;
        line-height: 1.5;
      }

      .msg.user .bubble { background: var(--panel-2); }

      .link-toggle {
        margin-top: 7px;
        border: 1px solid var(--line);
        border-radius: 999px;
        background: color-mix(in oklab, var(--accent-soft) 100%, var(--panel-2));
        color: var(--text);
        font-size: 10px;
        padding: 4px 8px;
        cursor: pointer;
      }

      .details {
        margin-top: 7px;
        border-top: 1px dashed var(--line);
        padding-top: 7px;
        display: none;
        gap: 4px;
        color: var(--muted);
        font-size: 10px;
      }

      .details.show { display: grid; }

      .timeline { display: grid; gap: 7px; }

      .event {
        border: 1px solid var(--line);
        border-radius: 10px;
        background: var(--panel-2);
        padding: 8px;
      }

      .event .meta {
        display: flex;
        justify-content: space-between;
        margin-bottom: 4px;
      }

      .event strong {
        display: block;
        font-size: 11px;
        margin-bottom: 3px;
      }

      .event p { margin: 0; font-size: 10px; color: var(--muted); }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      select,
      .controls button,
      .controls label {
        border: 1px solid var(--line);
        border-radius: 8px;
        background: var(--panel-2);
        color: var(--text);
        font-size: 10px;
        padding: 6px 8px;
      }

      .controls label {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
      }

      .composer {
        border-top: 1px solid var(--line);
        background: linear-gradient(180deg, color-mix(in oklab, var(--panel) 70%, transparent), var(--panel));
        padding: 10px;
        display: grid;
        gap: 7px;
        position: sticky;
        bottom: 0;
      }

      textarea {
        width: 100%;
        min-height: 82px;
        max-height: 190px;
        resize: none;
        border-radius: 10px;
        border: 1px solid color-mix(in oklab, var(--line) 90%, white);
        background: var(--panel-2);
        color: var(--text);
        padding: 9px;
        font-size: 12px;
        line-height: 1.45;
      }

      .hint {
        font-size: 10px;
        color: var(--subtle);
      }

      .composer .actions {
        display: flex;
        gap: 6px;
      }

      .composer .actions button {
        border: 1px solid var(--line);
        border-radius: 8px;
        height: 31px;
        padding: 0 10px;
        background: var(--panel-2);
        color: var(--text);
        font-size: 11px;
        cursor: pointer;
      }

      .composer .actions button.primary {
        border-color: color-mix(in oklab, var(--accent) 60%, var(--line));
        background: color-mix(in oklab, var(--accent) 34%, var(--panel-2));
      }

      .compact .page { padding: 8px; gap: 7px; }
      .compact .card { padding: 8px; }
      .compact .bubble { padding: 8px; font-size: 11px; }
      .compact .event { padding: 7px; }
      .compact .composer { padding: 8px; }
      .compact textarea { min-height: 66px; font-size: 11px; }

      .mission-overlay {
        position: fixed;
        inset: 0;
        background: rgba(4, 8, 14, 0.66);
        display: none;
        place-items: center;
      }

      .mission-overlay.show { display: grid; }

      .mission-card {
        width: min(92vw, 980px);
        height: min(86vh, 680px);
        border: 1px solid var(--line);
        border-radius: 16px;
        background: linear-gradient(180deg, var(--panel), #0f141d);
        box-shadow: var(--shadow);
        padding: 12px;
        display: grid;
        grid-template-rows: auto 1fr;
        gap: 10px;
      }

      .mission-head {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .mission-grid {
        display: grid;
        grid-template-columns: 1.2fr 1fr 300px;
        gap: 10px;
        min-height: 0;
      }

      .mission-pane {
        border: 1px solid var(--line);
        border-radius: 12px;
        background: var(--panel-2);
        padding: 10px;
        overflow: auto;
      }

      .mission-pane h4 { margin: 0 0 8px; font-size: 12px; }
+      @media (max-width: 960px) {
+        .mission-grid { grid-template-columns: 1fr; }
+      }
    </style>
  </head>
  <body data-theme="mono-mint">
    <main class="app" id="app">
      <header class="head">
        <div class="head-row">
          <div class="brand"><span class="brand-dot"></span><span>SENTINEL CHAT</span></div>
          <div class="head-actions">
            <button class="icon-btn" onclick="toggleMission()">Mission</button>
            <button class="icon-btn">âš™</button>
          </div>
        </div>
        <div class="status">
          <span class="pill ok">Connected</span>
          <span class="pill">Alignment 93%</span>
          <span class="pill">Policy Guarded</span>
          <span class="pill">Risk Low</span>
        </div>
      </header>

      <nav class="tabbar" id="tabbar">
        <button class="tab active" data-page="command">Command</button>
        <button class="tab" data-page="chat">Chat</button>
        <button class="tab" data-page="forge">Forge</button>
        <button class="tab" data-page="network">Network</button>
        <button class="tab" data-page="audit">Audit</button>
        <button class="tab" data-page="settings">Settings</button>
      </nav>

      <section class="body">
        <section class="page active" id="page-command">
          <div class="empty-hero">
            <div class="bot">ðŸ¤–</div>
            <h2>What can I do for you?</h2>
            <div class="recent">Recent tasks</div>
          </div>
          <article class="card">
            <h3>Operational Snapshot</h3>
            <div class="kv">
              <div class="row"><span>Goals completed</span><span>3 / 5</span></div>
              <div class="row"><span>Pending approvals</span><span>1</span></div>
              <div class="row"><span>Tool calls</span><span>12</span></div>
            </div>
          </article>
        </section>

        <section class="page" id="page-chat">
          <article class="card">
            <h3>Quick Actions</h3>
            <div class="controls">
              <button>/init</button><button>/memory-status</button><button>Validate</button><button>Regenerate</button>
            </div>
          </article>

          <article class="card">
            <div class="msg user">
              <div class="meta">User â€¢ 11:05</div>
              <div class="bubble">Build a home monitoring app with role-based access and realtime alerts.</div>
            </div>
            <div class="msg" style="margin-top:8px;">
              <div class="meta">Sentinel â€¢ 11:05</div>
              <div class="bubble">
                Plan ready with deterministic governance lock. Approval required for dependency drift.
                <button class="link-toggle" data-target="chatDetails">Show details</button>
                <div class="details" id="chatDetails">
                  <span>Intent aligned to active manifold.</span>
                  <span>Reliability healthy, zero active violations.</span>
                  <span>Trace TRN-C8F7A102-49</span>
                </div>
              </div>
            </div>
          </article>

          <article class="card">
            <h3>Timeline</h3>
            <div class="timeline">
              <div class="event"><div class="meta"><span>received</span><span>11:05:01</span></div><strong>Prompt accepted</strong><p>User intent parsed.</p></div>
              <div class="event"><div class="meta"><span>plan</span><span>11:05:02</span></div><strong>Goal decomposition</strong><p>4 atomic goals.</p></div>
              <div class="event"><div class="meta"><span>result</span><span>11:05:04</span></div><strong>Execution ready</strong><p>Waiting for confirmation.</p></div>
            </div>
          </article>
        </section>

        <section class="page" id="page-forge">
          <article class="card"><h3>Goal Forge</h3><p>Dependency topology and execution ordering.</p></article>
          <article class="card list">
            <div class="item"><strong>G1 Foundation</strong><small>Completed</small></div>
            <div class="item"><strong>G2 Backend Synthesis</strong><small>InProgress</small></div>
            <div class="item"><strong>G3 Frontend Synthesis</strong><small>Pending</small></div>
            <div class="item"><strong>G4 Verification</strong><small>Pending</small></div>
          </article>
        </section>

        <section class="page" id="page-network">
          <article class="card"><h3>Federation View</h3>
            <div class="kv">
              <div class="row"><span>Relay health</span><span>Nominal</span></div>
              <div class="row"><span>Active agents</span><span>1</span></div>
              <div class="row"><span>Secure channels</span><span>1/1</span></div>
            </div>
          </article>
        </section>

        <section class="page" id="page-audit">
          <article class="card"><h3>Execution Log</h3>
            <div class="list">
              <div class="item"><strong>TRN-C8F7A102-49</strong><small>Prompt -> planning</small></div>
              <div class="item"><strong>TRN-C8F7A102-50</strong><small>Governance lock check</small></div>
              <div class="item"><strong>TRN-C8F7A102-51</strong><small>Pending approval</small></div>
            </div>
          </article>
        </section>

        <section class="page" id="page-settings">
          <article class="card"><h3>Appearance</h3>
            <div class="controls">
              <select id="themeSelect">
                <option value="mono-mint">Monochrome Mint</option>
                <option value="warm-graphite">Warm Graphite</option>
                <option value="pure-vscode">Pure VSCode</option>
              </select>
              <label><input type="checkbox" id="compact" /> Compact density</label>
            </div>
          </article>
          <article class="card"><h3>Runtime Controls</h3>
            <div class="kv">
              <div class="row"><span>Action Gate</span><span>Enabled</span></div>
              <div class="row"><span>Governance Lock</span><span>Enabled</span></div>
              <div class="row"><span>Reliability SLO</span><span>Healthy</span></div>
            </div>
          </article>
        </section>
      </section>

      <footer class="composer">
        <textarea id="composer" placeholder="Type your task here...\nType @ for context, / for slash commands"></textarea>
        <div class="row">
          <span class="hint">Auto-approve: Read, Edit, Safe commands</span>
          <div class="actions">
            <button>Stop</button>
            <button class="primary">Act</button>
          </div>
        </div>
      </footer>
    </main>

    <div class="mission-overlay" id="missionOverlay">
      <div class="mission-card">
        <div class="mission-head">
          <strong>Mission Control</strong>
          <button class="mini-btn" onclick="toggleMission()">Close</button>
        </div>
        <div class="mission-grid">
          <div class="mission-pane"><h4>Execution Timeline</h4><div class="timeline"><div class="event"><div class="meta"><span>plan</span><span>11:05:02</span></div><strong>Decomposition done</strong><p>4 atomic goals with constraints.</p></div></div></div>
          <div class="mission-pane"><h4>Explainability</h4><p style="font-size:12px;color:var(--muted);">Intent aligned, reliability healthy, governance locked.</p></div>
          <div class="mission-pane"><h4>Governance</h4><p style="font-size:12px;color:var(--muted);">Pending proposal: websocket notifier package.</p></div>
        </div>
      </div>
    </div>

    <script>
      const tabbar = document.getElementById("tabbar");
      const pages = [...document.querySelectorAll(".page")];
      const app = document.getElementById("app");
      const themeSelect = document.getElementById("themeSelect");
      const compactToggle = document.getElementById("compact");
      const overlay = document.getElementById("missionOverlay");
      const composer = document.getElementById("composer");

      tabbar.addEventListener("click", (e) => {
        const btn = e.target.closest(".tab[data-page]");
        if (!btn) return;
        tabbar.querySelectorAll(".tab").forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        const page = btn.dataset.page;
        pages.forEach((p) => p.classList.toggle("active", p.id === `page-${page}`));
      });

      document.querySelectorAll(".link-toggle").forEach((btn) => {
        btn.addEventListener("click", () => {
          const target = document.getElementById(btn.dataset.target);
          const open = target.classList.toggle("show");
          btn.textContent = open ? "Hide details" : "Show details";
        });
      });

      themeSelect.addEventListener("change", () => {
        document.body.setAttribute("data-theme", themeSelect.value);
      });

      compactToggle.addEventListener("change", () => {
        app.classList.toggle("compact", compactToggle.checked);
      });

      function autoResize() {
        composer.style.height = "auto";
        const max = Math.min(190, Math.floor(window.innerHeight * 0.3));
        composer.style.height = Math.min(composer.scrollHeight, max) + "px";
        composer.style.overflowY = composer.scrollHeight > max ? "auto" : "hidden";
      }

      composer.addEventListener("input", autoResize);
      window.addEventListener("resize", autoResize);
      autoResize();

      window.toggleMission = function () {
        overlay.classList.toggle("show");
      };
    </script>
  </body>
</html>
